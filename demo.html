<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Flows for APEX - Viewer</title>

  <link rel="stylesheet" href="/assets/css/flows4apex.viewer.css" type="text/css"/>
  <!-- <link rel="stylesheet" href="/assets/bpmn-js/diagram-js.css" type="text/css"/>
  <link rel="stylesheet" href="/assets/bpmn-js/bpmn-js.css" type="text/css"/>
  <link rel="stylesheet" href="/assets/bpmn-js/bpmn-font/css/bpmn-embedded.css" type="text/css"/> -->
  <link rel="stylesheet" href="https://static.oracle.com/cdn/apex/24.2.0/libraries/font-apex/2.4/css/font-apex.min.css?v=24.2.0" type="text/css"/>
</head>

<style>
</style>

<body>
  <f4a-viewer
    regionId="viewer"
    allowDownload="true"
    addHighlighting="true"
    useBPMNcolors=false
    enableCallActivities="true"
    showToolbar="true"
    enableMousewheelZoom="true"
    themePluginClass="FLOWS-DARK" ></f4a-viewer>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // fetch("/assets/diagrams/SubProcessColors.bpmn")
      fetch("/assets/diagrams/A25i - Nested Parallel SubProcess Iterations.bpmn")
      .then(data => {
        data.text()
        .then(result => {
          const viewerElement = document.querySelector('f4a-viewer');
          viewerElement.loadDiagram(result);

          /* DEMO DATA - must be attached to element */
          viewerElement.current = ["Activity_A2"];
          viewerElement.completed = ["Event_Start","Activity_PreSplit","Activity_A1"];
          viewerElement.error = [];

          viewerElement.iterationData = {
            "Activity_A2": [
              {
                  "stepKey": "HzWFmaqGWC",
                  "loopCounter": 1,
                  "description": "Iteration A2 - iteration 1 (JONES)",
                  "parentStepKey": null,
                  "status": "running",
                  "highlighting": {
                      "completed": ["Event_A2Start"],
                      "current": ["Activity_A2a"]
                  }
              },
              {
                  "stepKey": "nzxcfwoPsq",
                  "loopCounter": 2,
                  "description": "Iteration A2 - iteration 2 (SCOTT)",
                  "parentStepKey": null,
                  "status": "running",
                  "highlighting": {
                      "completed": ["Event_A2Start","Activity_A2a"],
                      "current": ["Activity_A2b"]
                  }
              },
              {
                  "stepKey": "edFUfYXvyw",
                  "loopCounter": 3,
                  "description": "Iteration A2 - iteration 3 (FORD)",
                  "parentStepKey": null,
                  "status": "running",
                  "highlighting": {
                      "completed": ["Event_A2Start"],
                      "current": ["Activity_A2a"]
                  }
              },
              {
                  "stepKey": "sTtxLGXwia",
                  "loopCounter": 4,
                  "description": "Iteration A2 - iteration 4 (SMITH)",
                  "parentStepKey": null,
                  "status": "running",
                  "highlighting": {
                      "completed": ["Event_A2Start"],
                      "current": ["Activity_A2a"]
                  }
              },
              {
                  "stepKey": "sQOruNJpdv",
                  "loopCounter": 5,
                  "description": "Iteration A2 - iteration 5 (ADAMS)",
                  "parentStepKey": null,
                  "status": "running",
                  "highlighting": {
                      "completed": ["Event_A2Start"],
                      "current": ["Activity_A2a"]
                  }
              }
            ],
            "Activity_A2b": [
                {
                    "stepKey": "GCDKvCEvwm",
                    "loopCounter": 1,
                    "description": "Sub Iteration A2b - iteration 1 (BLAKE)",
                    "parentStepKey": "nzxcfwoPsq",
                    "status": "running",
                    "highlighting": {
                        "completed": ["Event_A2bStart"],
                        "current": ["Activity_A2b1"]
                    }
                }
            ],
            "Activity_A3": [
              {
                "stepKey": "12345",
                "loopCounter": 1,
                "description": "Iteration 1",
                "parentStepKey": null,
                "status": "running",
                "highlighting": {}
              },
              {
                "stepKey": "23456",
                "loopCounter": 2,
                "description": "Iteration 2",
                "parentStepKey": null,
                "status": "running",
                "highlighting": {}
              }
            ]
          };

          viewerElement.userTaskData = {
            "Activity_C3": "https://github.com/mt-ag/bpmn-viewer",
        };
        })
      })
      .catch(error => {
        console.error("could not load BPMN 2.0 diagram", error);
      });
    });
  </script>
  <script src="./bundle.js"></script>
</body>
</html>